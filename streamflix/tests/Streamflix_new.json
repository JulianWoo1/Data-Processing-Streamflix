{
  "info": {
    "name": "Streamflix API attempt 2",
    "description": "Comprehensive test collection for Streamflix API endpoints with edge cases",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5001",  
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "accountId",
      "value": "",
      "type": "string"
    },
    {
      "key": "profileId",
      "value": "",
      "type": "string"
    },
    {
      "key": "contentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "subscriptionId",
      "value": "",
      "type": "string"
    },
    {
      "key": "verificationToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "email",
      "value": "test@streamflix.com",
      "type": "string"
    },
    {
      "key": "password",
      "value": "Test@123",
      "type": "string"
    }
  ],
  "item": [
    {
        "name": "1. Account Endpoints",
        "item": [
          {
        "name": "Register - Valid",
        "event": [
          {
            "listen": "prerequest",
            "script": {
              "exec": [
                "// Generate a random number to make a unique email",
                "const random = Math.floor(Math.random() * 1000000);",
                "// Set a new email for this run",
                "pm.collectionVariables.set(\"email\", `test+${random}@streamflix.com`);",
                "// Optional: log the email to Postman console",
                "console.log(\"Using email for registration:\", pm.collectionVariables.get(\"email\"));"
              ]
            }
          },
          {
            "listen": "test",
            "script": {
              "exec": [
                "pm.test('Status code is 200', () => {",
                "    pm.response.to.have.status(200);",
                "});",
                "",
                "pm.test('Response has account ID', () => {",
                "    const json = pm.response.json();",
                "    pm.expect(json).to.have.property('accountId');",
                "    pm.collectionVariables.set('accountId', json.accountId);",
                "    pm.collectionVariables.set('verificationToken', json.verificationToken);",
                "});"
              ]
            }
          }
        ],
        "request": {
          "method": "POST",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\"\n}"
          },
          "url": "{{baseUrl}}/api/Account/register"
        }
      },
        {
          "name": "Register - Invalid Email",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', () => {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"invalid-email\",\n  \"password\": \"Test@123\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/register"
          }
        },
        {
          "name": "Register - Weak Password",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', () => {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"weak@test.com\",\n  \"password\": \"weak\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/register"
          }
        },
        {
          "name": "Verify Account - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"verificationToken\": \"{{verificationToken}}\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/verify"
          }
        },
        {
          "name": "Verify Account - Invalid Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', () => {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"verificationToken\": \"invalid-token\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/verify"
          }
        },
        {
          "name": "Login - Valid Credentials",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has token', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('token');",
                  "    pm.collectionVariables.set('token', json.token);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/login"
          }
        },
        {
          "name": "Login - Invalid Credentials",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 401', () => {",
                  "    pm.response.to.have.status(401);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"WrongPassword@123\"\n}"
            },
            "url": "{{baseUrl}}/api/Account/login"
          }
        },
        {
          "name": "Get Account Info - Authorized",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has account info', () => {",
                    "const json = pm.response.json();",
                    "pm.expect(json).to.have.property('accountId');",
                    "pm.expect(json).to.have.property('email');",
                    "pm.expect(json).to.have.property('isVerified');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Account/getAccountInfo"
          }
        },
        {
          "name": "Get Account Info - Unauthorized",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 401', () => {",
                  "    pm.response.to.have.status(401);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Account/getAccountInfo?email={{email}}"
          }
        }
      ]
    },
    {
      "name": "2. Profile Endpoints",
      "item": [
        {
          "name": "Create Profile - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', () => {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has profile ID', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('profileId');",
                  "    pm.collectionVariables.set('profileId', json.profileId);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"accountId\": {{accountId}},\n  \"name\": \"John Doe\",\n  \"ageCategory\": \"Adult\",\n  \"imageUrl\": \"https://example.com/profile.jpg\"\n}"
            },
            "url": "{{baseUrl}}/api/Profile" 
          }
        },
        {
          "name": "Create Profile - Invalid URL",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', () => {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"accountId\": {{accountId}},\n  \"name\": \"Jane Doe\",\n  \"ageCategory\": \"Adult\",\n  \"imageUrl\": \"not-a-valid-url\"\n}"
            },
            "url": "{{baseUrl}}/api/Profile"
          }
        },
        {
          "name": "Get All Profiles",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has profiles array', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('profiles');",
                  "    pm.expect(json.profiles).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Profile"
          }
        },
        {
          "name": "Get Profile by ID - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has profile data', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('name');",
                  "    pm.expect(json).to.have.property('ageCategory');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Profile/{{profileId}}"
          }
        },
        {
          "name": "Update Profile - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 204', () => {",
                  "    pm.response.to.have.status(204);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Updated\",\n  \"ageCategory\": \"Adult\",\n  \"imageUrl\": \"https://example.com/updated.jpg\"\n}"
            },
            "url": "{{baseUrl}}/api/Profile/{{profileId}}"
          }
        },
        {
          "name": "Update Profile Preference - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 204', () => {",
                  "    pm.response.to.have.status(204);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"preferredGenres\": [\"Action\", \"Drama\"],\n  \"contentType\": \"Movies\",\n  \"minimumAge\": 13,\n  \"contentFilters\": [\"Violence\"]\n}"
            },
            "url": "{{baseUrl}}/api/Profile/{{profileId}}/preference"
          }
        }
      ]
    },
    {
      "name": "3. Content Endpoints",
      "item": [
        {
          "name": "Get All Movies",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Content/movies"
          }
        },
        {
          "name": "Search Movies by Title",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Content/movies?title=Action"
          }
        },
        {
          "name": "Get Movies by Genre",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Content/movies?genre=Drama"
          }
        },
        {
          "name": "Create Movie - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', () => {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has content ID', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.collectionVariables.set('contentId', json.id);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Test Movie\",\n  \"description\": \"A test movie for API testing\",\n  \"ageRating\": 13,\n  \"imageURL\": \"https://example.com/movie.jpg\",\n  \"duration\": 120,\n  \"genre\": \"Action\",\n  \"contentWarnings\": [\"Violence\"],\n  \"availableQualities\": [\"HD\", \"4K\"]\n}"
            },
            "url": "{{baseUrl}}/api/Content/movies"
          }
        },
        {
          "name": "Create Movie - Invalid Age Rating",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', () => {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Invalid Movie\",\n  \"description\": \"Invalid age rating\",\n  \"ageRating\": 99,\n  \"duration\": 120,\n  \"genre\": \"Action\",\n  \"availableQualities\": [\"HD\"]\n}"
            },
            "url": "{{baseUrl}}/api/Content/movies"
          }
        },
        {
          "name": "Get Movie by ID - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Content/movies/{{contentId}}"
          }
        },
        {
          "name": "Get Movie by ID - Not Found",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 404', () => {",
                  "    pm.response.to.have.status(404);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Content/movies/99999"
          }
        },
        {
          "name": "Get Personalized Movies - Authorized",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Content/movies/personalized?profileId={{profileId}}"
          }
        }
      ]
    },
    {
      "name": "4. Subscription Endpoints",
      "item": [
        {
          "name": "Get Subscription Plans",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has plans', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('plans');",
                  "    pm.expect(json.plans).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/api/Subscription/plans"
          }
        },
        {
          "name": "Create Subscription - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', () => {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has subscription ID', () => {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('subscriptionId');",
                  "    pm.collectionVariables.set('subscriptionId', json.subscriptionId);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"subscriptionType\": \"HD\",\n  \"subscriptionDescription\": \"HD Quality Streaming\"\n}"
            },
            "url": "{{baseUrl}}/api/Subscription"
          }
        },
        {
          "name": "Create Subscription - Duplicate",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 409', () => {",
                  "    pm.response.to.have.status(409);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"subscriptionType\": \"HD\",\n  \"subscriptionDescription\": \"HD Quality Streaming\"\n}"
            },
            "url": "{{baseUrl}}/api/Subscription"
          }
        },
        {
          "name": "Get My Subscription",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Subscription"
          }
        },
        {
          "name": "Change Subscription - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"subscriptionId\": {{subscriptionId}},\n  \"newSubscriptionType\": \"UHD\",\n  \"newDescription\": \"Ultra HD Quality Streaming\",\n  \"newPrice\": 13.99\n}"
            },
            "url": "{{baseUrl}}/api/Subscription/{{subscriptionId}}"
          }
        }
      ]
    },
    {
      "name": "5. Watchlist Endpoints",
      "item": [
        {
          "name": "Get Watchlist by Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 404', () => {",
                  "    pm.expect([200, 404]).to.include(pm.response.code);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Watchlist/profile/{{profileId}}"
          }
        },
        {
          "name": "Add Content to Watchlist - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', () => {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Watchlist/profile/{{profileId}}/add/{{contentId}}"
          }
        },
        {
          "name": "Add Content to Watchlist - Not Found",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 404', () => {",
                  "    pm.response.to.have.status(404);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Watchlist/profile/{{profileId}}/add/99999"
          }
        },
        {
          "name": "Remove from Watchlist - Valid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 204', () => {",
                  "    pm.response.to.have.status(204);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": "{{baseUrl}}/api/Watchlist/profile/{{profileId}}/remove/{{contentId}}"
          }
        }
      ]
    },
    {
  "name": "6 Viewing History Endpoints",
  "item": [
    {
      "name": "Start Viewing - Valid",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"profileId\": {{profileId}},\n  \"contentId\": {{contentId}},\n  \"episodeId\": null\n}"
        },
        "url": "{{baseUrl}}/api/ViewingHistory"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 201', () => {",
              "    pm.response.to.have.status(201);",
              "});",
              "",
              "pm.test('Response has viewingHistoryId', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json).to.have.property('viewingHistoryId');",
              "    pm.collectionVariables.set('viewingHistoryId', json.viewingHistoryId);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Update Progress - Valid",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"lastPosition\": 3600,\n  \"isCompleted\": false\n}"
        },
        "url": "{{baseUrl}}/api/ViewingHistory/{{viewingHistoryId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 204', () => {",
              "    pm.response.to.have.status(204);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Resume Content - Valid",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": "{{baseUrl}}/api/ViewingHistory/resume/{{profileId}}/{{contentId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', () => { pm.response.to.have.status(200); });",
              "const json = pm.response.json();",
              "pm.expect(json.viewingHistoryId).to.eql(parseInt(pm.collectionVariables.get('viewingHistoryId')));"
            ]
          }
        }
      ]
    },
    {
      "name": "Mark as Completed",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": "{{baseUrl}}/api/ViewingHistory/{{viewingHistoryId}}/complete"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 204', () => { pm.response.to.have.status(204); });"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Viewing History",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": "{{baseUrl}}/api/ViewingHistory/{{profileId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', () => { pm.response.to.have.status(200); });",
              "const json = pm.response.json();",
              "const ids = json.viewingHistories.map(h => h.viewingHistoryId);",
              "pm.expect(ids).to.include(parseInt(pm.collectionVariables.get('viewingHistoryId')));"
            ]
          }
        }
      ]
    }
  ]
}
  ]
}